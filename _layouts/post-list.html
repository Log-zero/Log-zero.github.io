---
layout: default
---

{% if page.category %}
  {% assign posts = site.categories[page.category] %}

  {% assign subs = "" | split: "" %}
  {% for post in posts %}
    {% if post.subcategory %}
      {% unless subs contains post.subcategory %}
        {% assign subs = subs | push: post.subcategory %}
      {% endunless %}
    {% endif %}
  {% endfor %}

  {% if subs.size > 0 %}
    <div class="posts">
      {% for sub in subs %}
        {% assign label = site.data.subcategories[page.category][sub] | default: sub %}

        <div class="post">
          <h2 class="post-title">
            <a href="{{ '/categories/' | append: page.category | append: '/' | append: sub | append: '/' | relative_url }}">
              {{ label }}
            </a>
          </h2>

          <time class="post-meta">
            {{ posts | where: "subcategory", sub | size }} posts
          </time>
        </div>
      {% endfor %}
    </div>
  {% endif %}

{% endif %}